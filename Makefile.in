#
# Makefile --
#
# Top-level makefile for the Visualization Toolkit
# 
#------------------------------------------------------------------------------
#
SHELL=/bin/sh

#------------------------------------------------------------------------------
# Autoconfig defines that can be overridden in Config.mk

CC                = @CC@
CFLAGS            = @CFLAGS@
srcdir            = @srcdir@
VPATH             = @srcdir@
prefix            = @prefix@
exec_prefix       = @exec_prefix@
BUILD_TCL         = @BUILD_TCL@
CLEAN_TCL         = @CLEAN_TCL@
BUILD_JAVA        = @BUILD_JAVA@
CLEAN_JAVA        = @CLEAN_JAVA@
BUILD_GRAPHICS    = @BUILD_GRAPHICS@
DEPEND_GRAPHICS   = @DEPEND_GRAPHICS@
CLEAN_GRAPHICS    = @CLEAN_GRAPHICS@
BUILD_IMAGING     = @BUILD_IMAGING@
DEPEND_IMAGING    = @DEPEND_IMAGING@
CLEAN_IMAGING     = @CLEAN_IMAGING@
BUILD_PATENTED    = @BUILD_PATENTED@
DEPEND_PATENTED   = @DEPEND_PATENTED@
CLEAN_PATENTED    = @CLEAN_PATENTED@
BUILD_VOLUME      = @BUILD_VOLUME@
DEPEND_VOLUME     = @DEPEND_VOLUME@
CLEAN_VOLUME      = @CLEAN_VOLUME@
BUILD_CONTRIB     = @BUILD_CONTRIB@
DEPEND_CONTRIB    = @DEPEND_CONTRIB@
CLEAN_CONTRIB     = @CLEAN_CONTRIB@
BUILD_GEAE        = @BUILD_GEAE@
DEPEND_GEAE       = @DEPEND_GEAE@
CLEAN_GEAE        = @CLEAN_GEAE@
BUILD_GEMSIP      = @BUILD_GEMSIP@
DEPEND_GEMSIP     = @DEPEND_GEMSIP@
CLEAN_GEMSIP      = @CLEAN_GEMSIP@
BUILD_GEMSIO      = @BUILD_GEMSIO@
DEPEND_GEMSIO     = @DEPEND_GEMSIO@
CLEAN_GEMSIO      = @CLEAN_GEMSIO@
BUILD_GEMSVOLUME  = @BUILD_GEMSVOLUME@
DEPEND_GEMSVOLUME = @DEPEND_GEMSVOLUME@
CLEAN_GEMSVOLUME  = @CLEAN_GEMSVOLUME@

#------------------------------------------------------------------------------
# Include user-editable defines.

@MAKEINCLUDE@ @MAKEQUOTE@Config.mk@MAKEQUOTE@

#------------------------------------------------------------------------------

all: targets ${BUILD_TCL} ${BUILD_JAVA} build_common \
	${BUILD_GRAPHICS} ${BUILD_IMAGING} ${BUILD_VOLUME} \
	${BUILD_CONTRIB} ${BUILD_GEAE} ${BUILD_GEMSIP} ${BUILD_GEMSIO} \
	${BUILD_GEMSVOLUME} ${BUILD_PATENTED} \
	${BUILD_TCL}${BUILD_TCL} ${BUILD_JAVA}${BUILD_JAVA}

targets: ${srcdir}/targets.cxx ${srcdir}/makedepend.cxx
	${CXX} -o targets ${srcdir}/targets.cxx ${srcdir}/makedepend.cxx

build_common: targets ${BUILD_TCL} ${BUILD_JAVA}
	cd common;     ${MAKE} -${MAKEFLAGS} targets.make
	cd common;     ${MAKE} -${MAKEFLAGS} all

build_graphics: targets ${BUILD_TCL} ${BUILD_JAVA}
	cd graphics;   ${MAKE} -${MAKEFLAGS} targets.make
	cd graphics;   ${MAKE} -${MAKEFLAGS} all

build_imaging: targets ${BUILD_TCL} ${BUILD_JAVA}
	cd imaging;    ${MAKE} -${MAKEFLAGS} targets.make
	cd imaging;    ${MAKE} -${MAKEFLAGS} all

build_patented: targets ${BUILD_TCL} ${BUILD_JAVA}
	cd patented;    ${MAKE} -${MAKEFLAGS} targets.make
	cd patented;    ${MAKE} -${MAKEFLAGS} all

build_volume: targets ${BUILD_TCL} ${BUILD_JAVA}
	cd volume;    ${MAKE} -${MAKEFLAGS} targets.make
	cd volume;    ${MAKE} -${MAKEFLAGS} all

build_tcl: targets
	cd tcl;        ${MAKE} -${MAKEFLAGS} all

build_java: targets
	cd java;       ${MAKE} -${MAKEFLAGS} all

build_gemsio: targets ${BUILD_TCL} ${BUILD_JAVA}
	cd gemsio;     ${MAKE} -${MAKEFLAGS} targets.make
	cd gemsio;     ${MAKE} -${MAKEFLAGS} all

build_gemsvolume: targets ${BUILD_TCL} ${BUILD_JAVA}
	cd gemsvolume; ${MAKE} -${MAKEFLAGS} targets.make
	cd gemsvolume; ${MAKE} -${MAKEFLAGS} all

build_gemsip: targets ${BUILD_TCL} ${BUILD_JAVA}
	cd gemsip;     ${MAKE} -${MAKEFLAGS} targets.make
	cd gemsip;     ${MAKE} -${MAKEFLAGS} all

build_geae: targets ${BUILD_TCL} ${BUILD_JAVA}
	cd geae;     ${MAKE} -${MAKEFLAGS} targets.make
	cd geae;     ${MAKE} -${MAKEFLAGS} all

build_contrib: targets ${BUILD_TCL} ${BUILD_JAVA}
	cd contrib;     ${MAKE} -${MAKEFLAGS} targets.make
	cd contrib;     ${MAKE} -${MAKEFLAGS} all

# tcl part2
build_tclbuild_tcl: ${BUILD_TCL} ${BUILD_JAVA} build_common \
	${BUILD_GRAPHICS} ${BUILD_IMAGING} ${BUILD_VOLUME} \
	${BUILD_CONTRIB} ${BUILD_GEAE} ${BUILD_GEMSIP} ${BUILD_GEMSIO} \
	${BUILD_GEMSVOLUME} ${BUILD_PATENTED}
	cd tcl;        ${MAKE} -${MAKEFLAGS} vtk

# java part2
build_javabuild_java: ${BUILD_TCL} ${BUILD_JAVA} build_common \
	${BUILD_GRAPHICS} ${BUILD_IMAGING} ${BUILD_VOLUME} \
	${BUILD_CONTRIB} ${BUILD_GEAE} ${BUILD_GEMSIP} ${BUILD_GEMSIO} \
	${BUILD_GEMSVOLUME} ${BUILD_PATENTED}
	cd java;       ${MAKE} -${MAKEFLAGS} vtk

#------------------------------------------------------------------------------
# generate dpend.make files

depend: ${DEPEND_TCL} ${DEPEND_GRAPHICS} ${DEPEND_IMAGING} ${DEPEND_PATENTED} \
	${DEPEND_VOLUME} ${DEPEND_GEMSVOLUME} \
	${DEPEND_CONTRIB} ${DEPEND_GEAE} ${DEPEND_GEMSIP} ${DEPEND_GEMSIO} 
	cd common;    ${MAKE} -${MAKEFLAGS} depend

depend_tcl:
	cd tcl;       ${MAKE} -${MAKEFLAGS} depend

depend_graphics:
	cd graphics;  ${MAKE} -${MAKEFLAGS} depend

depend_imaging:
	cd imaging;   ${MAKE} -${MAKEFLAGS} depend

depend_patented:
	cd patented;    ${MAKE} -${MAKEFLAGS} depend

depend_volume:
	cd volume;    ${MAKE} -${MAKEFLAGS} depend

depend_contrib:
	cd contrib; ${MAKE} -${MAKEFLAGS} depend

depend_geae:
	cd geae; ${MAKE} -${MAKEFLAGS} depend

depend_gemsip:
	cd gemsip; ${MAKE} -${MAKEFLAGS} depend

depend_gemsio:
	cd gemsio; ${MAKE} -${MAKEFLAGS} depend

depend_gemsvolume:
	cd gemsvolume; ${MAKE} -${MAKEFLAGS} depend

#------------------------------------------------------------------------------
# Clean up all files that were built by make.
clean: ${CLEAN_TCL} ${CLEAN_JAVA} ${CLEAN_GRAPHICS} ${CLEAN_IMAGING} \
	${CLEAN_VOLUME} ${CLEAN_GEMSVOLUME} ${CLEAN_PATENTED} \
	${CLEAN_CONTRIB} ${CLEAN_GEAE} ${CLEAN_GEMSIP} ${CLEAN_GEMSIO} 
	cd common;    ${MAKE} -${MAKEFLAGS} clean
	rm -f config.cache

clean_tcl:
	cd tcl;       ${MAKE} -${MAKEFLAGS} clean

clean_java:
	cd java;      ${MAKE} -${MAKEFLAGS} clean

clean_graphics:
	cd graphics;  ${MAKE} -${MAKEFLAGS} clean

clean_imaging:
	cd imaging;   ${MAKE} -${MAKEFLAGS} clean

clean_patented:
	cd patented;    ${MAKE} -${MAKEFLAGS} clean

clean_volume:
	cd volume;    ${MAKE} -${MAKEFLAGS} clean

clean_contrib:
	cd contrib;   ${MAKE} -${MAKEFLAGS} clean

clean_geae:
	cd geae; ${MAKE} -${MAKEFLAGS} clean

clean_gemsip:
	cd gemsip; ${MAKE} -${MAKEFLAGS} clean

clean_gemsio:
	cd gemsio; ${MAKE} -${MAKEFLAGS} clean

clean_gemsvolume:
	cd gemsvolume; ${MAKE} -${MAKEFLAGS} clean

