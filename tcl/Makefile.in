#
# vtk library makefile
#

#
# Makefile for Visualization Toolkit sources. 
# 
#------------------------------------------------------------------------------
#

SHELL = /bin/sh
.SUFFIXES: .cxx

srcdir        = @srcdir@
VPATH         = @srcdir@

#------------------------------------------------------------------------------
# Autoconfig defines that can be overridden in user.make

@MAKEINCLUDE@ @MAKEQUOTE@../system.make@MAKEQUOTE@

#------------------------------------------------------------------------------
# Include user-editable defines.

@MAKEINCLUDE@ @MAKEQUOTE@../user.make@MAKEQUOTE@

#------------------------------------------------------------------------------
LDLIBS =  \
	${USE_PARALLEL_LIBS}	\
	${USE_LOCAL_LIBS}	\
	${USE_CONTRIB_LIBS}	\
	${USE_PATENTED_LIBS}	\
	${USE_IMAGING_LIBS}	\
	${USE_GRAPHICS_LIBS}	\
        -L../common -lVTKCommonTcl -lVTKCommon \
	${XLIBS} ${GRAPHICS_API_LIBS} ${CONTROLLER_API_LIBS} \
	${TK_LIB} ${TCL_LIB} ${DL_LIBS} \
	${THREAD_LIBS}


CXX_FLAGS = ${USER_CXXFLAGS} ${CPPFLAGS} ${CXXFLAGS} -I${srcdir} \
	-I${srcdir}/../common -I../common ${TK_INCLUDE} ${TCL_INCLUDE} \
	${GRAPHICS_API_FLAGS} ${CONTROLLER_API_FLAGS} \
	${USE_TOOLKIT_FLAGS}

C_FLAGS = ${USER_CFLAGS} ${CPPFLAGS} ${CFLAGS} -I${srcdir} \
	-I${srcdir}/../common -I../common ${TK_INCLUDE} ${TCL_INCLUDE} \
	${GRAPHICS_API_FLAGS} ${CONTROLLER_API_FLAGS} ${USE_TOOLKIT_FLAGS}

all: 

tkAppInit.o: tkAppInit.cxx Makefile
	$(CXX) $(CXX_FLAGS) -c -o tkAppInit.o $(srcdir)/tkAppInit.cxx

vtktcl.o: vtktcl.c Makefile
	$(CC) $(C_FLAGS) -c -o vtktcl.o $(srcdir)/vtktcl.c

#------------------------------------------------------------------------------
# build the vtk executable
#
vtk$(EXEEXT): 	Makefile tkAppInit.o ${TOOLKIT_DEPENDS} 
	$(CXX) -o $@ tkAppInit.o \
	-L. ${CXX_FLAGS} ${VTK_SHLIB_LINK_FLAGS} ${XLDFLAGS} ${LDLIBS} \
	${XLIBS} ${XEXT_LIB} ${XT_LIB} ${X_PRE_LIBS} ${X11_LIB} ${X_EXTRA_LIBS} ${MATH_LIB}

vtktcl$(EXEEXT): Makefile vtktcl.o ${TOOLKIT_DEPENDS}
	${CXX} -o $@ vtktcl.o \
	-L. ${CXX_FLAGS} ${VTK_SHLIB_BUILD_FLAGS} ${XLDFLAGS} ${LDLIBS} \
	${XLIBS} ${XEXT_LIB} ${XT_LIB} ${X_PRE_LIBS} ${X11_LIB} ${X_EXTRA_LIBS} ${MATH_LIB}
# This target is for Cygwin and Mingw.
vtktcl.dll: Makefile vtktcl.o ${TOOLKIT_DEPENDS}
	${SHLIB_LD} -o $@ vtktcl.o \
	-L. ${CXX_FLAGS} ${VTK_SHLIB_BUILD_FLAGS} ${XLDFLAGS} ${LDLIBS}

#------------------------------------------------------------------------------
# install
#
install: vtk
	@for i in vtk$(EXEEXT) $(VTK_TCL_SHLIB_TARGET) ; do \
	  ${INSTALL} -m 755 $$i $(BIN_INSTALL_DIR)/$$i; \
	done


#------------------------------------------------------------------------------
clean: 
	-rm -f vtktcl vtk$(EXEEXT) vtktcl.dll *.o *.a cpp_parse kit_init Makefile


